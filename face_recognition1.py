# -*- coding: cp1251 -*-
import cv2
import numpy as np
import os
from tkinter import *
from PIL import Image, ImageTk
import matplotlib.pyplot as plt
from random import randint
import tkinter
from pathlib import Path
import cv2 as cv
from collections import Counter
import time
import random




def gist_one16(path):
    img = cv2.imread(path, cv2.IMREAD_GRAYSCALE)
    gist = [[0 for i in range(32)] for j in range(16)]
    for i in range(112):
        for j in range(92):
            gist[(i // 28) * 4 + (j // 23)][int(img[i][j]) // 8] += 1
    otvet = []
    for i in range(16):
        for j in range(32):
            otvet.append(gist[i][j])
    return otvet


def gist_all16(n):
    otvet = [[[] for i in range(10)] for j in range(n)]
    for j in range(n):
        otvet[j][0] = gist_one16(f"img/etalon/{j + 1}.pgm")
    for i in range(n):
        for h in range(9):
            otvet[i][h + 1] = gist_one16(f"img/sh/s{i + 1}/{h + 2}.pgm")
    return otvet

def sravnenie_gist16(n, zapis):
    otvet = gist_all16(n)
    for i in range(n):
        for h in range(9):
            minimum = 100000000
            mesto = 0
            for j in range(n):
                gist1 = otvet[j][0]
                gist2 = otvet[i][h+1]
                raznica = 0
                for a in range(32 * 16):
                    raznica += abs(gist1[a] - gist2[a])
                if raznica < minimum:
                    mesto = j
                    minimum = raznica
            zapis[i*9+h][0] = mesto


def read_all(n):
    otvet = [[[] for i in range(10)] for j in range(n)]
    for j in range(n):
        otvet[j][0] = cv2.imread(f"img/etalon/{j+1}.pgm",  cv2.IMREAD_GRAYSCALE)
    for i in range(n):
        for h in range(9):
            otvet[i][h+1] = cv2.imread(f"img/sh/s{i+1}/{h+2}.pgm",  cv2.IMREAD_GRAYSCALE)
    return otvet


def sravnenie_kv(n, zapis):
    otvet = read_all(n)
    for i in range(n):
        for h in range(9):
            minimum = 10 ** 9
            mesto = 0
            for j in range(n):
                mas1 = otvet[j][0]
                mas2 = otvet[i][h + 1]
                raznica = 0
                for a in range(112):
                    for b in range(92):
                        raznica += abs(int(mas1[a][b])-int(mas2[a][b])) ** 2
                if raznica < minimum:
                    mesto = j
                    minimum = raznica
            zapis[i * 9 + h][1] = mesto


def rand_dotes(n, zapis, count_dotes):
    dotes = [[102, 87], [80, 83], [45, 14], [111, 31], [43, 25], [52, 33], [78, 67], [107, 37], [68, 62], [90, 87], [35, 82], [17, 54], [23, 33], [23, 14], [64, 17], [93, 90], [92, 53], [35, 58], [47, 1], [26, 60], [47, 50], [86, 54], [5, 12], [86, 32], [43, 14], [67, 61], [40, 4], [56, 74], [29, 37], [33, 0], [90, 57], [43, 7], [26, 42], [39, 52], [6, 65], [23, 57], [12, 73], [0, 0], [94, 30], [21, 16], [5, 51], [0, 60], [108, 58], [1, 77], [16, 51], [29, 52], [17, 49], [86, 34], [12, 60], [83, 1], [98, 3], [35, 17], [16, 72], [50, 85], [34, 49], [6, 80], [18, 3], [62, 28], [36, 46], [79, 18], [22, 59], [100, 76], [45, 9], [104, 53], [20, 1], [91, 46], [51, 23], [77, 57], [57, 71], [25, 47], [11, 75], [66, 33], [6, 8], [26, 49], [43, 1], [59, 50], [2, 79], [51, 10], [4, 7], [55, 10], [48, 74], [25, 67], [55, 85], [37, 7], [45, 37], [24, 36], [110, 16], [38, 31], [2, 50], [7, 88], [85, 6], [97, 7], [47, 54], [3, 66], [51, 51], [86, 73], [49, 72], [81, 21], [10, 48], [68, 59], [16, 85], [78, 74], [60, 32], [72, 46], [107, 6], [21, 24], [82, 46], [13, 2], [78, 44], [51, 11], [64, 91], [110, 52], [0, 62], [8, 78], [74, 53], [107, 39], [91, 68], [59, 3], [74, 61], [101, 90], [61, 22], [20, 80], [77, 8], [92, 36], [15, 53], [12, 35], [53, 73], [6, 76], [70, 17], [81, 29], [21, 79], [30, 20], [14, 90], [83, 60], [0, 68], [44, 47], [4, 29], [7, 52], [26, 69], [10, 22], [21, 83], [94, 62], [108, 85], [3, 79], [29, 32], [111, 73], [89, 83], [31, 41], [68, 61], [84, 79], [15, 29], [104, 30], [41, 57], [25, 29], [103, 86], [53, 23], [25, 74], [107, 32], [15, 3], [83, 89], [110, 59], [100, 54], [48, 18], [103, 38], [96, 26], [19, 74], [48, 3], [67, 30], [60, 68], [81, 27], [45, 54], [37, 63], [93, 43], [11, 1], [8, 11], [3, 12], [37, 75], [99, 41], [18, 59], [86, 71], [57, 8], [98, 46], [91, 7], [29, 46], [73, 18], [58, 84], [2, 8], [64, 1], [35, 29], [53, 75], [94, 73], [29, 26], [7, 6], [76, 4], [36, 46], [68, 74], [8, 15], [93, 40], [63, 54], [9, 81], [37, 91], [15, 36], [89, 9], [32, 66], [47, 36], [10, 42], [36, 56], [28, 4], [27, 47], [4, 84], [35, 90], [39, 63], [111, 90], [83, 63], [95, 0], [72, 23], [105, 62], [17, 40], [23, 69], [60, 11], [45, 28], [40, 12], [62, 66], [91, 72], [104, 85], [4, 85], [17, 5], [14, 57], [9, 25], [18, 1], [56, 46], [7, 20], [102, 84], [53, 12], [99, 72], [37, 77], [52, 61], [70, 90], [12, 49], [25, 25], [99, 36], [75, 74], [5, 17], [7, 39], [31, 74], [13, 82], [4, 85], [61, 66], [55, 77], [23, 3], [59, 74], [49, 1], [61, 14], [46, 65], [23, 42], [16, 33], [111, 33], [36, 73], [30, 46], [38, 79], [90, 45], [45, 85], [57, 72], [89, 5], [36, 16], [108, 82], [83, 9], [104, 91], [32, 25], [70, 47], [102, 19], [63, 74], [31, 48], [78, 68], [21, 15], [2, 0], [104, 37], [10, 6], [35, 74], [75, 43], [63, 45], [19, 11], [23, 0], [7, 42], [73, 15], [90, 28], [75, 18], [108, 21], [35, 50], [36, 11], [72, 46], [61, 60], [71, 73], [14, 37], [0, 70], [41, 33], [101, 32], [33, 17], [39, 57], [36, 48], [25, 24], [7, 65], [21, 20], [93, 62], [78, 36], [84, 37], [4, 74], [49, 75], [0, 45], [106, 43], [36, 87], [88, 58], [46, 42], [89, 15], [7, 64], [109, 88], [37, 6], [48, 26], [81, 11], [80, 30], [89, 36], [4, 8], [53, 67], [77, 82], [13, 42], [10, 6], [70, 82], [36, 11], [22, 74], [93, 52], [108, 33], [15, 25], [38, 75], [53, 11], [25, 7], [35, 60], [100, 88], [103, 38], [83, 38], [17, 86], [107, 58], [95, 51], [54, 85], [36, 61], [53, 82], [100, 2], [50, 35], [35, 8], [79, 66], [73, 83], [5, 57], [16, 47], [12, 77], [45, 49], [10, 18], [87, 11], [71, 91], [110, 9], [32, 38], [85, 69], [47, 74], [86, 53], [106, 60], [67, 68], [42, 87], [66, 12], [24, 3], [76, 23], [73, 45], [101, 83], [109, 42], [84, 65], [108, 39], [94, 86], [66, 1], [102, 9], [27, 40], [0, 57], [79, 49], [60, 45], [1, 63], [98, 32], [47, 9], [9, 73], [64, 72], [38, 54], [69, 38], [110, 52], [96, 52], [3, 79], [101, 6], [78, 38], [15, 12], [43, 22], [8, 39], [94, 44], [45, 1], [12, 76], [95, 12], [94, 35], [28, 72], [61, 47], [110, 1], [56, 64], [78, 81], [75, 91], [111, 54], [43, 67], [66, 4], [36, 25], [17, 26], [0, 76], [13, 78], [6, 64], [95, 67], [97, 26], [69, 89], [6, 45], [34, 69], [63, 44], [6, 70], [68, 56], [25, 87], [110, 23], [49, 22], [103, 26], [54, 65], [36, 26], [50, 18], [37, 86], [99, 70], [59, 13], [69, 87], [32, 4], [84, 35], [9, 81], [10, 40], [69, 10], [111, 69], [37, 87], [80, 73], [59, 4], [73, 59], [71, 87], [109, 39], [100, 48], [74, 23], [59, 88], [12, 91], [61, 10], [111, 84], [40, 79], [12, 49], [35, 58], [16, 51], [73, 23], [80, 76], [81, 17], [104, 73], [29, 35], [23, 34], [79, 44], [14, 43], [50, 66], [28, 82], [31, 79], [15, 38], [28, 43], [25, 79], [93, 21], [1, 64], [94, 46], [10, 85], [15, 44], [75, 2], [84, 45], [6, 73], [92, 28], [99, 89], [57, 60], [27, 4], [66, 2], [99, 12], [17, 68], [31, 68], [72, 70], [99, 82], [46, 48], [111, 72], [56, 47], [42, 89], [78, 78], [61, 49], [61, 68], [84, 40], [86, 85], [50, 39], [57, 46], [69, 5], [33, 66], [88, 76], [81, 46], [21, 82], [50, 30], [28, 78], [47, 79], [43, 86], [35, 40], [83, 5], [79, 38], [78, 27], [53, 68], [78, 17], [5, 72], [83, 15], [88, 75], [38, 0], [1, 80], [77, 76], [74, 61], [12, 52], [94, 2], [30, 24], [111, 0], [16, 58], [97, 34], [105, 21], [7, 55], [14, 85], [110, 31], [18, 4], [22, 22], [33, 8], [96, 8], [86, 39], [9, 58], [82, 7], [47, 76], [56, 46], [87, 81], [83, 86], [70, 20], [38, 62], [105, 16], [47, 66], [13, 2], [11, 90], [99, 30], [98, 36], [96, 16], [18, 29], [26, 39], [106, 60], [29, 74], [91, 25], [46, 42], [43, 22], [10, 9], [109, 54], [7, 49], [20, 59], [85, 90], [26, 12], [18, 27], [89, 49], [85, 16], [97, 64], [101, 7], [8, 59], [63, 79], [3, 46], [28, 89], [7, 45], [64, 56], [54, 38], [67, 54], [1, 40], [99, 38], [20, 40], [47, 68], [21, 51], [79, 86], [96, 60], [48, 59], [104, 22], [0, 88], [5, 40], [16, 30], [73, 42], [79, 88], [110, 80], [97, 62], [53, 31], [4, 63], [11, 81], [98, 90], [55, 18], [31, 49], [22, 82], [75, 4], [11, 23], [98, 2], [8, 79], [106, 34], [94, 40], [5, 76], [6, 70], [76, 91], [110, 78], [86, 15], [103, 54], [29, 21], [45, 21], [16, 23], [42, 60], [50, 29], [9, 65], [29, 60], [76, 74], [74, 91], [80, 9], [55, 34], [18, 27], [34, 31], [88, 85], [19, 29], [10, 10], [55, 74], [79, 81], [26, 33], [111, 87], [34, 66], [102, 38], [40, 64], [40, 33], [43, 43], [65, 69], [52, 13], [43, 33], [72, 24], [39, 9], [106, 75], [102, 24], [5, 79], [95, 73], [96, 34], [90, 16], [62, 2], [64, 63], [47, 39], [70, 89], [26, 89], [50, 75], [12, 91], [104, 69], [22, 42], [31, 27], [39, 51], [95, 31], [89, 46], [13, 17], [103, 64], [82, 56], [93, 30], [92, 72], [8, 31], [34, 69], [37, 82], [18, 34], [70, 88], [80, 22], [48, 1], [86, 12], [43, 39], [15, 14], [87, 37], [20, 49], [106, 75], [101, 49], [76, 36], [94, 17], [95, 18], [60, 76], [1, 61], [50, 19], [75, 60], [79, 39], [47, 90], [76, 84], [89, 57], [61, 43], [17, 84], [109, 36], [46, 19], [62, 47], [58, 28], [47, 13], [65, 26], [32, 16], [110, 70]]
    otvet = read_all(n)
    for i in range(n):
        for h in range(9):
            minimum = 10 ** 9
            mesto = 0
            for j in range(n):
                mas1 = otvet[j][0]
                mas2 = otvet[i][h + 1]
                raznica = 0
                for d in range(count_dotes):
                    raznica += abs(int(mas1[dotes[d][0]][dotes[d][1]]) - int(mas2[dotes[d][0]][dotes[d][1]])) ** 2
                if raznica < minimum:
                    mesto = j
                    minimum = raznica
            zapis[i * 9 + h][1] = mesto


def read_for_shatie(n):
    schitivaem = read_all(n)
    otvet = [[[[0 for b in range(92 // 4)] for a in range(112 // 4)] for i in range(10)] for j in range(n)]
    for j in range(n):
        for i in range(10):
            for a in range(112):
                for b in range(92):
                    otvet[j][i][a // 4][b // 4] += schitivaem[j][i][a][b]//16
    return otvet
def shatie(n, zapis):
    otvet = read_for_shatie(n)
    for i in range(n):
        for h in range(9):
            minimum = 10 ** 9
            mesto = 0
            mas2 = otvet[i][h + 1]
            for j in range(n):
                mas1 = otvet[j][0]
                raznica = 0
                for a in range(112 // 4):
                    for b in range(92 // 4):
                        raznica += abs(int(mas1[a][b])-int(mas2[a][b])) ** 2
                if raznica < minimum:
                    mesto = j
                    minimum = raznica
            zapis[i * 9 + h][2] = mesto

#------------------------------------------------------------------------------

def showimage(mylbl,path): #Функция отображения Lebel изображения в интерфейсе
    img = Image.open(path) # Открывваем изображение с помощью библиотеки PIL
    img = ImageTk.PhotoImage(img)
    mylbl.config(image=img) # Присваиваем Лейбел наше изображение
    mylbl.image = img
    mylbl.pack(side=LEFT) # Отрисовываем лейбел с параметром лево,чтобы изображения были в строчку

def showtext(mylbl):
    mylbl.pack(side=LEFT) #Отрисовываем лейбел текст

def stop():
    time.sleep(6)

n = 40
vse_rezultati = [[0 for i in range(3)] for j in range(n * 9)]
obshiy_rezultat = [0 for i in range(n * 9)]
pravilno = 0

sravnenie_gist16(n, vse_rezultati)
print("sravnenie_gist16 is done!")
rand_dotes(n, vse_rezultati, 700)
print("rand_dotes is done!")
shatie(n, vse_rezultati)
print("shatie is done!")
pravilno = 0
count = 0


gist_results = [0, 0, 26, 26, 0, 0, 26, 26, 26, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 25, 25, 25, 25, 25, 25, 25, 3, 3, 3, 3, 25, 25, 3, 4, 4, 4, 39, 39, 4, 39, 39, 17, 5, 5, 17, 17, 17, 17, 17, 17, 17, 6, 6, 22, 22, 6, 6, 6, 6, 16, 7, 7, 7, 13, 7, 7, 11, 7, 7, 8, 8, 25, 25, 25, 25, 25, 25, 25, 9, 9, 13, 13, 9, 9, 10, 10, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 25, 25, 25, 25, 11, 25, 11, 11, 11, 12, 12, 12, 17, 12, 17, 17, 12, 17, 13, 13, 13, 13, 13, 13, 13, 13, 13, 34, 14, 14, 34, 14, 34, 14, 34, 34, 0, 0, 6, 16, 15, 0, 0, 0, 0, 16, 16, 16, 16, 6, 6, 18, 6, 6, 17, 17, 17, 4, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 30, 30, 30, 19, 30, 19, 30, 19, 30, 20, 20, 29, 29, 29, 29, 29, 29, 29, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 8, 2, 8, 2, 8, 22, 22, 22, 23, 14, 14, 18, 23, 23, 23, 29, 29, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 16, 16, 27, 16, 27, 27, 27, 28, 28, 29, 29, 29, 29, 29, 28, 28, 29, 29, 33, 30, 29, 33, 33, 29, 29, 30, 4, 4, 4, 30, 30, 30, 30, 33, 31, 31, 31, 31, 31, 14, 31, 31, 31, 32, 32, 32, 29, 29, 29, 29, 29, 32, 33, 33, 33, 29, 33, 29, 33, 33, 33, 34, 34, 34, 39, 39, 39, 24, 12, 39, 23, 15, 13, 35, 15, 15, 15, 15, 26, 6, 36, 6, 6, 6, 36, 6, 36, 36, 8, 19, 37, 19, 37, 19, 37, 37, 2, 38, 38, 38, 38, 38, 38, 38, 38, 38, 24, 39, 24, 39, 24, 39, 24, 17, 24]
#vse_rezultati = [[0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 17], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [16, 16, 16], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [1, 1, 1], [2, 2, 2], [2, 2, 2], [2, 2, 2], [2, 4, 4], [22, 2, 2], [22, 2, 2], [2, 2, 2], [2, 2, 2], [2, 2, 2], [3, 3, 3], [12, 3, 3], [3, 3, 3], [3, 3, 3], [3, 3, 3], [3, 3, 3], [3, 3, 3], [3, 3, 3], [3, 3, 3], [4, 4, 4], [4, 4, 4], [4, 4, 4], [39, 4, 4], [39, 4, 4], [4, 4, 4], [39, 4, 39], [39, 4, 39], [39, 39, 39], [5, 5, 5], [5, 5, 5], [5, 5, 5], [5, 5, 5], [5, 5, 5], [5, 5, 5], [5, 5, 5], [5, 5, 5], [5, 5, 5], [6, 6, 6], [6, 6, 6], [6, 6, 6], [6, 6, 6], [6, 6, 6], [6, 6, 6], [6, 6, 6], [6, 6, 6], [6, 6, 6], [7, 7, 7], [7, 7, 7], [7, 7, 7], [7, 7, 7], [7, 7, 7], [7, 7, 7], [7, 7, 7], [7, 7, 7], [7, 3, 7], [8, 8, 8], [8, 8, 8], [8, 8, 8], [8, 8, 8], [37, 37, 37], [37, 37, 37], [37, 22, 22], [8, 8, 8], [3, 8, 8], [9, 9, 9], [9, 8, 8], [9, 8, 8], [9, 22, 22], [9, 22, 22], [9, 9, 9], [9, 9, 9], [9, 37, 37], [9, 3, 3], [10, 10, 10], [10, 10, 10], [10, 10, 10], [10, 14, 10], [10, 10, 10], [10, 10, 10], [10, 10, 10], [10, 10, 10], [10, 10, 10], [11, 11, 11], [25, 11, 11], [25, 11, 11], [25, 11, 11], [11, 11, 11], [25, 2, 11], [11, 11, 11], [11, 11, 11], [11, 11, 11], [12, 12, 12], [12, 12, 12], [12, 12, 12], [12, 12, 12], [3, 17, 17], [12, 12, 12], [12, 12, 12], [12, 12, 12], [12, 12, 12], [13, 13, 13], [13, 13, 13], [13, 13, 13], [13, 13, 13], [13, 13, 13], [13, 13, 13], [13, 13, 13], [13, 21, 21], [13, 13, 13], [34, 4, 4], [14, 14, 14], [14, 14, 14], [34, 4, 29], [14, 14, 14], [34, 4, 4], [14, 14, 14], [34, 4, 39], [34, 4, 29], [0, 23, 15], [0, 23, 23], [16, 17, 17], [6, 17, 17], [15, 15, 15], [0, 16, 14], [0, 26, 26], [0, 0, 0], [0, 23, 23], [16, 16, 16], [6, 2, 2], [6, 22, 22], [16, 16, 16], [16, 22, 22], [16, 23, 23], [16, 22, 6], [16, 22, 22], [16, 22, 23], [17, 17, 17], [17, 4, 4], [17, 17, 17], [17, 17, 17], [17, 17, 17], [17, 17, 17], [17, 17, 17], [17, 17, 17], [17, 17, 17], [18, 18, 18], [18, 18, 18], [18, 18, 18], [18, 18, 18], [18, 18, 18], [18, 18, 18], [26, 18, 18], [18, 1, 14], [18, 18, 18], [29, 28, 29], [32, 29, 29], [19, 28, 28], [19, 19, 19], [19, 28, 28], [19, 19, 19], [29, 29, 29], [19, 19, 19], [32, 28, 28], [20, 20, 20], [20, 20, 20], [30, 20, 20], [30, 20, 20], [30, 20, 30], [29, 20, 20], [20, 20, 20], [29, 20, 20], [30, 20, 20], [21, 21, 21], [21, 21, 21], [21, 21, 21], [21, 21, 21], [21, 21, 21], [21, 21, 21], [21, 21, 21], [21, 21, 21], [21, 21, 21], [22, 22, 22], [22, 22, 22], [22, 22, 37], [2, 8, 8], [22, 22, 22], [22, 22, 22], [22, 22, 22], [22, 22, 37], [22, 22, 22], [23, 23, 23], [23, 23, 23], [23, 23, 23], [23, 23, 23], [23, 23, 23], [23, 23, 23], [23, 23, 23], [23, 23, 23], [23, 23, 23], [24, 24, 24], [24, 24, 24], [24, 4, 4], [24, 4, 4], [24, 24, 24], [24, 24, 24], [24, 4, 4], [24, 24, 24], [24, 24, 24], [25, 25, 25], [25, 25, 25], [25, 25, 25], [25, 25, 25], [25, 25, 25], [25, 25, 25], [25, 39, 39], [25, 25, 25], [25, 39, 39], [26, 26, 26], [26, 26, 26], [26, 26, 26], [26, 26, 26], [26, 26, 3], [26, 10, 10], [26, 26, 26], [26, 26, 26], [26, 26, 26], [13, 14, 14], [27, 27, 27], [13, 18, 18], [13, 14, 14], [27, 27, 27], [13, 18, 18], [27, 36, 36], [16, 16, 16], [27, 27, 27], [28, 28, 28], [28, 28, 28], [29, 28, 28], [29, 28, 28], [29, 28, 28], [29, 28, 28], [37, 28, 28], [28, 28, 28], [28, 28, 28], [29, 29, 29], [29, 29, 29], [29, 29, 29], [29, 29, 29], [29, 29, 29], [29, 29, 29], [29, 29, 29], [29, 29, 29], [29, 29, 29], [33, 21, 21], [33, 33, 33], [33, 33, 33], [33, 33, 33], [30, 30, 30], [30, 30, 30], [30, 30, 30], [30, 30, 30], [33, 33, 33], [31, 31, 31], [31, 31, 31], [31, 31, 31], [31, 31, 31], [31, 31, 31], [31, 6, 14], [31, 31, 31], [31, 31, 31], [31, 1, 31], [32, 32, 32], [32, 32, 32], [32, 32, 32], [32, 32, 32], [32, 32, 32], [32, 32, 32], [29, 29, 29], [32, 32, 32], [32, 32, 32], [33, 33, 33], [33, 33, 33], [33, 33, 33], [33, 33, 33], [33, 33, 33], [33, 33, 33], [33, 33, 33], [33, 33, 33], [33, 33, 33], [34, 24, 24], [34, 4, 4], [34, 24, 24], [34, 39, 39], [2, 3, 24], [34, 24, 24], [34, 24, 24], [27, 39, 39], [34, 39, 39], [23, 22, 22], [15, 6, 6], [16, 6, 6], [35, 35, 35], [15, 16, 23], [23, 23, 23], [16, 6, 6], [14, 6, 6], [15, 16, 16], [25, 13, 13], [36, 36, 36], [25, 13, 13], [25, 13, 13], [25, 13, 13], [36, 36, 36], [25, 21, 13], [36, 36, 36], [36, 36, 36], [37, 22, 22], [37, 37, 37], [37, 3, 3], [37, 37, 37], [37, 37, 37], [37, 37, 37], [37, 22, 22], [37, 37, 37], [37, 22, 22], [38, 38, 38], [38, 38, 38], [38, 38, 38], [38, 38, 38], [28, 28, 28], [38, 38, 38], [38, 38, 38], [38, 38, 38], [28, 28, 28], [39, 39, 39], [39, 39, 39], [4, 4, 4], [39, 39, 39], [34, 4, 4], [39, 39, 39], [2, 39, 39], [39, 39, 39], [4, 4, 4]]
#gist_all16(40)

count = 0
def printing(i): # Функция отображает все найденные изображения и после вызывает себя от следующего i
    global pravilno
    global count
    metod1path = f"img/etalon/{vse_rezultati[i][0] + 1}.pgm"
    metod2path = f"img/etalon/{vse_rezultati[i][1] + 1}.pgm"
    metod3path = f"img/etalon/{vse_rezultati[i][2] + 1}.pgm"
    etalonimage = f"img/etalon/{i // 9 + 1}.pgm"
    if vse_rezultati[i][2] == vse_rezultati[i][1]:
        voutingpath = f"img/etalon/{vse_rezultati[i][2] + 1}.pgm"
        testimgpath = f"img/sh/s{i // 9 + 1}/{i % 9 + 2}.pgm"

        if i // 9 == vse_rezultati[i][2]:
            pravilno += 1

    else:
        voutingpath = f"img/etalon/{vse_rezultati[i][0] + 1}.pgm"
        testimgpath = f"img/sh/s{i // 9 + 1}/{i % 9 + 2}.pgm"
        if i // 9 == vse_rezultati[i][0]:
            pravilno += 1
    count += 1

    showimage(label0, etalonimage)
    showimage(label1, testimgpath) # Функция рисует изображение в окне с помощью пути и любого лейбла
    showimage(label2, voutingpath)
    showimage(label3,metod1path)
    showimage(label4, metod2path)
    showimage(label5, metod3path)
    showimage(label6, f"img/etalon/{gist_results[i]+1}.pgm")

    showtext(l0txt)
    showtext(l1txt) # Функция рисует заданный текстовый лейбел
    showtext(l2txt)
    showtext(l3txt)
    showtext(l4txt)
    showtext(l5txt)
    showtext(l6txt)

    showimage(label10, f"img/gist/{i // 9 + 1}.{i % 9 + 2}.png")
    showimage(label11, f"img/gist16/{i // 9 + 1}.{i % 9 + 2}.png")
    showimage(label12, f"img/rand/{i // 9 + 1}.{i % 9 + 2}.pgm")
    showimage(label13, f"img/mash/{i // 9 + 1}.{i % 9 + 2}.pgm")
    showtext(l10txt)
    showtext(l11txt)
    showtext(l12txt)
    showtext(l13txt)
    showtext(l22txt)

    if i < 9 * 40 - 1:
        root.after(1000, printing, i + 1)  # call loop(n+1) in 0.2 seconds


root = Tk() # Инициализирует окно
root.title('Faces') #Название окна
# Set the resolution of window
root.geometry("650x350") # размер окна
frm = Frame(root) # Область снизу для кнопки выход
frm.pack(side=BOTTOM, padx=15, pady=15) # расположение этой области
f_top = Frame(root) # Ещё две области для самих изображений
f_bot = Frame(root) # и текста под ним
label1 = Label(f_top) # Создание обектов ЛЕЙБЕЛ которые можгут отображаться в окне
label2 = Label(f_top)
label3 = Label(f_top)
label4 = Label(f_top)
label5 = Label(f_top)
label0 = Label(f_top)
label6 = Label(f_top)
l1txt = Label(f_bot,width=10,text='Test image') #Текстовые лейблы
l2txt = Label(f_bot,width=13,text='Voting image')
l3txt = Label(f_bot,width=13,text='Metod 1')
l4txt = Label(f_bot,width=10,text='Metod 2')
l5txt = Label(f_bot,width=10,text='Metod 3')
l0txt = Label(f_bot,width=10,text='Эталон')
l6txt = Label(f_bot,width=10,text='Гист.')

f_top.pack() # команда pack рисует что-то в окне
f_bot.pack() # команда pack рисует что-то в окне


f1_top = Frame(root)
f1_bot = Frame(root)
f2_bot = Frame(root)
label10 = Label(f1_top, width=700)
label11 = Label(f1_top, width=700)
label12 = Label(f1_top)
label13 = Label(f1_top)
l10txt = Label(f1_bot,width=90,text='gist')
l11txt = Label(f1_bot,width=90,text='gist16')
l12txt = Label(f1_bot,width=13,text='random dotes')
l13txt = Label(f1_bot,width=13,text='сжатие')

l22txt = Label(f2_bot, text="красная линия - тестовое изоб.,  зеленая линия - искомый эталон,  синяя линия - найденный эталон")
f1_top.pack()
f1_bot.pack()
f2_bot.pack()
btn1 = Button(frm, text="Stop", command=lambda: stop())
btn1.pack(side=tkinter.LEFT, padx=40)

btn2 = Button(frm, text="Exit", command=lambda: exit()) # кнопка выхода с присвоенной ей функцией выхода
btn2.pack(side=tkinter.LEFT, padx=40)

root.after_idle(printing, 0)  # start loop
root.after(60*100000, root.destroy)
root.mainloop()
print(pravilno/count)
